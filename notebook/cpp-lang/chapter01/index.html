<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/vuepress-cpp-notes/favicon.svg"><title>C++ 课程学习笔记（上） | C++ 笔记</title><meta name="description" content="C++ 课程学习笔记（上）">
    <link rel="preload" href="/vuepress-cpp-notes/assets/style-ae1efe3a.css" as="style"><link rel="stylesheet" href="/vuepress-cpp-notes/assets/style-ae1efe3a.css">
    <link rel="modulepreload" href="/vuepress-cpp-notes/assets/app-dd112ad8.js"><link rel="modulepreload" href="/vuepress-cpp-notes/assets/framework-8980b429.js"><link rel="modulepreload" href="/vuepress-cpp-notes/assets/index.html-0c782a4a.js"><link rel="modulepreload" href="/vuepress-cpp-notes/assets/index.html-d9388164.js"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-170a236f.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-41a589fe.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-5c605f02.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-6f01e712.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/c-variable-arguments.html-c1424d77.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-a4241d13.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-c35d6bff.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-4350e5f1.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/mt19937.html-08cd38d4.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/define-fraction-adt.html-5fae7a8d.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/how-to-swap-two-array.html-49d48b96.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-5fd8b053.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-490e64b7.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-c5e3096b.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/404.html-e7f61752.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-35837a2a.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-3d775e41.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-6da869ab.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-0a69dc98.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/c-variable-arguments.html-9bba30ac.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-e43c2437.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-5c9ee3d6.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-586279b0.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/mt19937.html-b88644e4.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/define-fraction-adt.html-d57caf25.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/how-to-swap-two-array.html-4d409cec.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-7ee15ff4.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-fd22e1e1.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/index.html-23e8ed2e.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/404.html-b3328390.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/mermaid.core-f8070833.js" as="script"><link rel="prefetch" href="/vuepress-cpp-notes/assets/SearchResult-130fbd90.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/vuepress-cpp-notes/" class=""><img class="logo" src="/vuepress-cpp-notes/favicon.svg" alt="C++ 笔记"><span class="site-name can-hide">C++ 笔记</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/Sun-ZhenXing/vuepress-cpp-notes/" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!--[--><button class="search-pro-button" role="search" aria-label="搜索"><svg xmlns="http://www.w3.org/2000/svg" class="icon search-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="search icon"><path d="M192 480a256 256 0 1 1 512 0 256 256 0 0 1-512 0m631.776 362.496-143.2-143.168A318.464 318.464 0 0 0 768 480c0-176.736-143.264-320-320-320S128 303.264 128 480s143.264 320 320 320a318.016 318.016 0 0 0 184.16-58.592l146.336 146.368c12.512 12.48 32.768 12.48 45.28 0 12.48-12.512 12.48-32.768 0-45.28"></path></svg><div class="placeholder">搜索</div><div class="key-hints"><kbd class="key">Ctrl</kbd><kbd class="key">K</kbd></div></button><!--]--></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a class="external-link" href="https://github.com/Sun-ZhenXing/vuepress-cpp-notes/" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">C++ 课程学习笔记（上） <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_1-前言" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. 前言"><!--[--><!--]--> 1. 前言 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_1-1-讲解内容" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.1 讲解内容"><!--[--><!--]--> 1.1 讲解内容 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_1-2-永不过时的语言" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.2 永不过时的语言"><!--[--><!--]--> 1.2 永不过时的语言 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-利用汇编挖掘编程语言本质" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. 利用汇编挖掘编程语言本质"><!--[--><!--]--> 2. 利用汇编挖掘编程语言本质 <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-1-错误示范" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.1 错误示范"><!--[--><!--]--> 2.1 错误示范 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-2-学习建议" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.2 学习建议"><!--[--><!--]--> 2.2 学习建议 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-3-程序的本质" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.3 程序的本质"><!--[--><!--]--> 2.3 程序的本质 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-4-编程语言的发展" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.4 编程语言的发展"><!--[--><!--]--> 2.4 编程语言的发展 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-5-编程语言的本质区别" class="router-link-active router-link-exact-active sidebar-item" aria-label="2.5 编程语言的本质区别"><!--[--><!--]--> 2.5 编程语言的本质区别 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-基础语法-a" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. 基础语法 A"><!--[--><!--]--> 3. 基础语法 A <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-1-开发环境的搭建" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.1 开发环境的搭建"><!--[--><!--]--> 3.1 开发环境的搭建 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-2-cin-cout" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.2 cin / cout"><!--[--><!--]--> 3.2 cin / cout <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-3-函数重载-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.3 函数重载 1"><!--[--><!--]--> 3.3 函数重载 1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-4-函数重载-2-name-mangling" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.4 函数重载 2：name mangling"><!--[--><!--]--> 3.4 函数重载 2：name mangling <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-5-函数重载-3-利用-ida-分析-exe" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.5 函数重载 3：利用 IDA 分析 .exe"><!--[--><!--]--> 3.5 函数重载 3：利用 IDA 分析 .exe <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-6-默认参数" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.6 默认参数"><!--[--><!--]--> 3.6 默认参数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-7-extern-c-1-作用" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.7 extern &quot;C&quot; 1：作用"><!--[--><!--]--> 3.7 extern &quot;C&quot; 1：作用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-8-extern-c-2-c-c-混合开发" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.8 extern &quot;C&quot; 2：C/C++ 混合开发"><!--[--><!--]--> 3.8 extern &quot;C&quot; 2：C/C++ 混合开发 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-9-extern-c-3-cplusplus" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.9 extern &quot;C&quot; 3：__cplusplus"><!--[--><!--]--> 3.9 extern &quot;C&quot; 3：__cplusplus <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-10-extern-c-4-ifndef-define-endif" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.10 extern &quot;C&quot; 4：#ifndef / #define / #endif"><!--[--><!--]--> 3.10 extern &quot;C&quot; 4：#ifndef / #define / #endif <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-基础语法-b" class="router-link-active router-link-exact-active sidebar-item" aria-label="4. 基础语法 B"><!--[--><!--]--> 4. 基础语法 B <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-1-extern-c-5-pragma-once" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.1 extern &quot;C&quot; 5：#pragma once"><!--[--><!--]--> 4.1 extern &quot;C&quot; 5：#pragma once <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-2-内联函数-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.2 内联函数 1"><!--[--><!--]--> 4.2 内联函数 1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-3-内联函数-2-本质" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.3 内联函数 2：本质"><!--[--><!--]--> 4.3 内联函数 2：本质 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-4-内联函数-3-宏" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.4 内联函数 3：宏"><!--[--><!--]--> 4.4 内联函数 3：宏 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-5-const" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.5 const"><!--[--><!--]--> 4.5 const <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-6-引用-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.6 引用 1"><!--[--><!--]--> 4.6 引用 1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-7-引用-2" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.7 引用 2"><!--[--><!--]--> 4.7 引用 2 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-8-汇编-1-x86-x64-汇编" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.8 汇编 1：x86_x64 汇编"><!--[--><!--]--> 4.8 汇编 1：x86_x64 汇编 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-9-汇编-2-内联汇编" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.9 汇编 2：内联汇编"><!--[--><!--]--> 4.9 汇编 2：内联汇编 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-10-汇编-3-mov-指令" class="router-link-active router-link-exact-active sidebar-item" aria-label="4.10 汇编 3：mov 指令"><!--[--><!--]--> 4.10 汇编 3：mov 指令 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-基础语法-c" class="router-link-active router-link-exact-active sidebar-item" aria-label="5. 基础语法 C"><!--[--><!--]--> 5. 基础语法 C <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-1-汇编-4-call-指令" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.1 汇编 4：call 指令"><!--[--><!--]--> 5.1 汇编 4：call 指令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-2-汇编-5-其他常见指令" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.2 汇编 5：其他常见指令"><!--[--><!--]--> 5.2 汇编 5：其他常见指令 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-3-汇编-6-intel-白皮书" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.3 汇编 6：Intel 白皮书"><!--[--><!--]--> 5.3 汇编 6：Intel 白皮书 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-4-汇编-7-jcc" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.4 汇编 7：JCC"><!--[--><!--]--> 5.4 汇编 7：JCC <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-5-汇编-8-反汇编分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.5 汇编 8：反汇编分析"><!--[--><!--]--> 5.5 汇编 8：反汇编分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-6-引用-3-反汇编分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.6 引用 3：反汇编分析"><!--[--><!--]--> 5.6 引用 3：反汇编分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-7-引用-4-注意点" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.7 引用 4：注意点"><!--[--><!--]--> 5.7 引用 4：注意点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-8-引用-5-const-引用" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.8 引用 5：const 引用"><!--[--><!--]--> 5.8 引用 5：const 引用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-9-引用-6-const-引用的特点" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.9 引用 6：const 引用的特点"><!--[--><!--]--> 5.9 引用 6：const 引用的特点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-10-引用-7-mov-指令补充、数组的引用" class="router-link-active router-link-exact-active sidebar-item" aria-label="5.10 引用 7：mov 指令补充、数组的引用"><!--[--><!--]--> 5.10 引用 7：mov 指令补充、数组的引用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-面向对象-a" class="router-link-active router-link-exact-active sidebar-item" aria-label="6. 面向对象 A"><!--[--><!--]--> 6. 面向对象 A <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-1-面向对象-1-类和对象" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.1 面向对象 1：类和对象"><!--[--><!--]--> 6.1 面向对象 1：类和对象 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-2-面向对象-2-对象的内存" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.2 面向对象 2：对象的内存"><!--[--><!--]--> 6.2 面向对象 2：对象的内存 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-3-面向对象-3-this" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.3 面向对象 3：this"><!--[--><!--]--> 6.3 面向对象 3：this <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-4-面向对象-4-指针访问的本质" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.4 面向对象 4：指针访问的本质"><!--[--><!--]--> 6.4 面向对象 4：指针访问的本质 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-5-面向对象-5-指针的思考题" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.5 面向对象 5：指针的思考题"><!--[--><!--]--> 6.5 面向对象 5：指针的思考题 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-6-面向对象-6-0xcc" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.6 面向对象 6：0xCC"><!--[--><!--]--> 6.6 面向对象 6：0xCC <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-7-内存-1-封装、内存布局、堆空间" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.7 内存 1：封装、内存布局、堆空间"><!--[--><!--]--> 6.7 内存 1：封装、内存布局、堆空间 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-8-内存-2-malloc-free" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.8 内存 2：malloc / free"><!--[--><!--]--> 6.8 内存 2：malloc / free <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-9-内存-3-new-delete" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.9 内存 3：new / delete"><!--[--><!--]--> 6.9 内存 3：new / delete <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-10-内存-4-堆空间的初始化" class="router-link-active router-link-exact-active sidebar-item" aria-label="6.10 内存 4：堆空间的初始化"><!--[--><!--]--> 6.10 内存 4：堆空间的初始化 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-面向对象-b" class="router-link-active router-link-exact-active sidebar-item" aria-label="7. 面向对象 B"><!--[--><!--]--> 7. 面向对象 B <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-1-内存-5-对象的内存" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.1 内存 5：对象的内存"><!--[--><!--]--> 7.1 内存 5：对象的内存 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-2-构造函数-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.2 构造函数 1"><!--[--><!--]--> 7.2 构造函数 1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-3-构造函数-2" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.3 构造函数 2"><!--[--><!--]--> 7.3 构造函数 2 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-4-成员变量的初始化" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.4 成员变量的初始化"><!--[--><!--]--> 7.4 成员变量的初始化 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-5-析构函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.5 析构函数"><!--[--><!--]--> 7.5 析构函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-6-内存管理" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.6 内存管理"><!--[--><!--]--> 7.6 内存管理 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-7-声明和实现分离" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.7 声明和实现分离"><!--[--><!--]--> 7.7 声明和实现分离 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-8-命名空间" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.8 命名空间"><!--[--><!--]--> 7.8 命名空间 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-9-继承" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.9 继承"><!--[--><!--]--> 7.9 继承 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-10-成员访问权限" class="router-link-active router-link-exact-active sidebar-item" aria-label="7.10 成员访问权限"><!--[--><!--]--> 7.10 成员访问权限 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-面向对象-c" class="router-link-active router-link-exact-active sidebar-item" aria-label="8. 面向对象 C"><!--[--><!--]--> 8. 面向对象 C <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-1-初始化列表-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.1 初始化列表 1"><!--[--><!--]--> 8.1 初始化列表 1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-2-初始化列表-2-构造函数的互相调用" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.2 初始化列表 2：构造函数的互相调用"><!--[--><!--]--> 8.2 初始化列表 2：构造函数的互相调用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-3-初始化列表-3-父类的构造函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.3 初始化列表 3：父类的构造函数"><!--[--><!--]--> 8.3 初始化列表 3：父类的构造函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-4-多态-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.4 多态 1"><!--[--><!--]--> 8.4 多态 1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-5-多态-2-虚函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.5 多态 2：虚函数"><!--[--><!--]--> 8.5 多态 2：虚函数 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-6-多态-3-虚表" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.6 多态 3：虚表"><!--[--><!--]--> 8.6 多态 3：虚表 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-7-多态-4-虚表的汇编分析" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.7 多态 4：虚表的汇编分析"><!--[--><!--]--> 8.7 多态 4：虚表的汇编分析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-8-多态-5-虚表的作用" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.8 多态 5：虚表的作用"><!--[--><!--]--> 8.8 多态 5：虚表的作用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-9-多态-6-虚表的细节" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.9 多态 6：虚表的细节"><!--[--><!--]--> 8.9 多态 6：虚表的细节 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-10-多态-7-调用父类的成员函数" class="router-link-active router-link-exact-active sidebar-item" aria-label="8.10 多态 7：调用父类的成员函数"><!--[--><!--]--> 8.10 多态 7：调用父类的成员函数 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="c-学习笔记-上" tabindex="-1"><a class="header-anchor" href="#c-学习笔记-上" aria-hidden="true">#</a> C++ 学习笔记（上）</h1><p>本文是 C++ 学习笔记，结合 C++11 底层和特征讲解，并包含实战。全课程一共 16 章，这里记录 1~8 章的内容。</p><nav class="table-of-contents"><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_1-前言" class="router-link-active router-link-exact-active">1. 前言</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_1-1-讲解内容" class="router-link-active router-link-exact-active">1.1 讲解内容</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_1-2-永不过时的语言" class="router-link-active router-link-exact-active">1.2 永不过时的语言</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-利用汇编挖掘编程语言本质" class="router-link-active router-link-exact-active">2. 利用汇编挖掘编程语言本质</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-1-错误示范" class="router-link-active router-link-exact-active">2.1 错误示范</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-2-学习建议" class="router-link-active router-link-exact-active">2.2 学习建议</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-3-程序的本质" class="router-link-active router-link-exact-active">2.3 程序的本质</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-4-编程语言的发展" class="router-link-active router-link-exact-active">2.4 编程语言的发展</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_2-5-编程语言的本质区别" class="router-link-active router-link-exact-active">2.5 编程语言的本质区别</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-基础语法-a" class="router-link-active router-link-exact-active">3. 基础语法 A</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-1-开发环境的搭建" class="router-link-active router-link-exact-active">3.1 开发环境的搭建</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-2-cin-cout" class="router-link-active router-link-exact-active">3.2 cin / cout</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-3-函数重载-1" class="router-link-active router-link-exact-active">3.3 函数重载 1</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-4-函数重载-2-name-mangling" class="router-link-active router-link-exact-active">3.4 函数重载 2：name mangling</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-5-函数重载-3-利用-ida-分析-exe" class="router-link-active router-link-exact-active">3.5 函数重载 3：利用 IDA 分析 .exe</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-6-默认参数" class="router-link-active router-link-exact-active">3.6 默认参数</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-7-extern-c-1-作用" class="router-link-active router-link-exact-active">3.7 extern &quot;C&quot; 1：作用</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-8-extern-c-2-c-c-混合开发" class="router-link-active router-link-exact-active">3.8 extern &quot;C&quot; 2：C/C++ 混合开发</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-9-extern-c-3-cplusplus" class="router-link-active router-link-exact-active">3.9 extern &quot;C&quot; 3：__cplusplus</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_3-10-extern-c-4-ifndef-define-endif" class="router-link-active router-link-exact-active">3.10 extern &quot;C&quot; 4：#ifndef / #define / #endif</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-基础语法-b" class="router-link-active router-link-exact-active">4. 基础语法 B</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-1-extern-c-5-pragma-once" class="router-link-active router-link-exact-active">4.1 extern &quot;C&quot; 5：#pragma once</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-2-内联函数-1" class="router-link-active router-link-exact-active">4.2 内联函数 1</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-3-内联函数-2-本质" class="router-link-active router-link-exact-active">4.3 内联函数 2：本质</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-4-内联函数-3-宏" class="router-link-active router-link-exact-active">4.4 内联函数 3：宏</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-5-const" class="router-link-active router-link-exact-active">4.5 const</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-6-引用-1" class="router-link-active router-link-exact-active">4.6 引用 1</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-7-引用-2" class="router-link-active router-link-exact-active">4.7 引用 2</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-8-汇编-1-x86-x64-汇编" class="router-link-active router-link-exact-active">4.8 汇编 1：x86_x64 汇编</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-9-汇编-2-内联汇编" class="router-link-active router-link-exact-active">4.9 汇编 2：内联汇编</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_4-10-汇编-3-mov-指令" class="router-link-active router-link-exact-active">4.10 汇编 3：mov 指令</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-基础语法-c" class="router-link-active router-link-exact-active">5. 基础语法 C</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-1-汇编-4-call-指令" class="router-link-active router-link-exact-active">5.1 汇编 4：call 指令</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-2-汇编-5-其他常见指令" class="router-link-active router-link-exact-active">5.2 汇编 5：其他常见指令</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-3-汇编-6-intel-白皮书" class="router-link-active router-link-exact-active">5.3 汇编 6：Intel 白皮书</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-4-汇编-7-jcc" class="router-link-active router-link-exact-active">5.4 汇编 7：JCC</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-5-汇编-8-反汇编分析" class="router-link-active router-link-exact-active">5.5 汇编 8：反汇编分析</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-6-引用-3-反汇编分析" class="router-link-active router-link-exact-active">5.6 引用 3：反汇编分析</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-7-引用-4-注意点" class="router-link-active router-link-exact-active">5.7 引用 4：注意点</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-8-引用-5-const-引用" class="router-link-active router-link-exact-active">5.8 引用 5：const 引用</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-9-引用-6-const-引用的特点" class="router-link-active router-link-exact-active">5.9 引用 6：const 引用的特点</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_5-10-引用-7-mov-指令补充、数组的引用" class="router-link-active router-link-exact-active">5.10 引用 7：mov 指令补充、数组的引用</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-面向对象-a" class="router-link-active router-link-exact-active">6. 面向对象 A</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-1-面向对象-1-类和对象" class="router-link-active router-link-exact-active">6.1 面向对象 1：类和对象</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-2-面向对象-2-对象的内存" class="router-link-active router-link-exact-active">6.2 面向对象 2：对象的内存</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-3-面向对象-3-this" class="router-link-active router-link-exact-active">6.3 面向对象 3：this</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-4-面向对象-4-指针访问的本质" class="router-link-active router-link-exact-active">6.4 面向对象 4：指针访问的本质</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-5-面向对象-5-指针的思考题" class="router-link-active router-link-exact-active">6.5 面向对象 5：指针的思考题</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-6-面向对象-6-0xcc" class="router-link-active router-link-exact-active">6.6 面向对象 6：0xCC</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-7-内存-1-封装、内存布局、堆空间" class="router-link-active router-link-exact-active">6.7 内存 1：封装、内存布局、堆空间</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-8-内存-2-malloc-free" class="router-link-active router-link-exact-active">6.8 内存 2：malloc / free</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-9-内存-3-new-delete" class="router-link-active router-link-exact-active">6.9 内存 3：new / delete</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_6-10-内存-4-堆空间的初始化" class="router-link-active router-link-exact-active">6.10 内存 4：堆空间的初始化</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-面向对象-b" class="router-link-active router-link-exact-active">7. 面向对象 B</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-1-内存-5-对象的内存" class="router-link-active router-link-exact-active">7.1 内存 5：对象的内存</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-2-构造函数-1" class="router-link-active router-link-exact-active">7.2 构造函数 1</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-3-构造函数-2" class="router-link-active router-link-exact-active">7.3 构造函数 2</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-4-成员变量的初始化" class="router-link-active router-link-exact-active">7.4 成员变量的初始化</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-5-析构函数" class="router-link-active router-link-exact-active">7.5 析构函数</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-6-内存管理" class="router-link-active router-link-exact-active">7.6 内存管理</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-7-声明和实现分离" class="router-link-active router-link-exact-active">7.7 声明和实现分离</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-8-命名空间" class="router-link-active router-link-exact-active">7.8 命名空间</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-9-继承" class="router-link-active router-link-exact-active">7.9 继承</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_7-10-成员访问权限" class="router-link-active router-link-exact-active">7.10 成员访问权限</a></li></ul></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-面向对象-c" class="router-link-active router-link-exact-active">8. 面向对象 C</a><ul><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-1-初始化列表-1" class="router-link-active router-link-exact-active">8.1 初始化列表 1</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-2-初始化列表-2-构造函数的互相调用" class="router-link-active router-link-exact-active">8.2 初始化列表 2：构造函数的互相调用</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-3-初始化列表-3-父类的构造函数" class="router-link-active router-link-exact-active">8.3 初始化列表 3：父类的构造函数</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-4-多态-1" class="router-link-active router-link-exact-active">8.4 多态 1</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-5-多态-2-虚函数" class="router-link-active router-link-exact-active">8.5 多态 2：虚函数</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-6-多态-3-虚表" class="router-link-active router-link-exact-active">8.6 多态 3：虚表</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-7-多态-4-虚表的汇编分析" class="router-link-active router-link-exact-active">8.7 多态 4：虚表的汇编分析</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-8-多态-5-虚表的作用" class="router-link-active router-link-exact-active">8.8 多态 5：虚表的作用</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-9-多态-6-虚表的细节" class="router-link-active router-link-exact-active">8.9 多态 6：虚表的细节</a></li><li><a aria-current="page" href="/vuepress-cpp-notes/notebook/cpp-lang/chapter01/#_8-10-多态-7-调用父类的成员函数" class="router-link-active router-link-exact-active">8.10 多态 7：调用父类的成员函数</a></li></ul></li></ul></nav><div class="hint-container info"><p class="hint-container-title">课程简介</p><p>该课程的讲师是 <a href="https://ke.qq.com/teacher/199109106" target="_blank" rel="noopener noreferrer">小码哥：李明杰老师<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，该课程在腾讯课堂上可以找到 <a href="https://ke.qq.com/course/336509" target="_blank" rel="noopener noreferrer"><em>30 小时快速精通 C++ 和游戏辅助实战</em><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>（付费 ￥666）。此处记录主要用于复习参考，另外包含资料：</p><ul><li>代码</li><li>课件（PDF）</li><li>部分程序（反汇编工具等）</li><li>待破解的程序、游戏</li></ul></div><h2 id="_1-前言" tabindex="-1"><a class="header-anchor" href="#_1-前言" aria-hidden="true">#</a> 1. 前言</h2><div class="hint-container warning"><p class="hint-container-title">预备知识</p><p>此课程需要 C 语言的基础知识。</p></div><h3 id="_1-1-讲解内容" tabindex="-1"><a class="header-anchor" href="#_1-1-讲解内容" aria-hidden="true">#</a> 1.1 讲解内容</h3><ul><li>常用语法 <ul><li>C++ 常用语法</li><li>反汇编窥探底层</li></ul></li><li>面向对象 <ul><li>多态 / 虚函数是如何实现的</li><li>内存布局是怎样的</li></ul></li><li>项目实战 <ul><li><code>Windows</code> 编程 <ul><li><code>Windows API</code></li><li><code>MFC</code></li></ul></li><li>x86 编程</li><li>软件破解 <ul><li>外挂制作</li></ul></li></ul></li></ul><p>通过反汇编掌握底层原理，对于了解其他语言至关重要。</p><h3 id="_1-2-永不过时的语言" tabindex="-1"><a class="header-anchor" href="#_1-2-永不过时的语言" aria-hidden="true">#</a> 1.2 永不过时的语言</h3><p>C++ 的应用领域：</p><ul><li>游戏、图像、多媒体、网络、嵌入式</li><li>数据库、浏览器、搜索引擎</li><li>操作系统、驱动程序、编译器、编程语言</li><li>高性能计算（HPC）</li><li>iOS 开发</li><li>Android 开发</li><li>Java 开发</li></ul><p>C++ 是进阶必备。语言有不同层次：汇编 -&gt; C -&gt; C++ -&gt; Java -&gt; C# -&gt; PHP。</p><ol><li>是底层技术和永不过时的技术</li><li>但是每一种语言都有自己的优缺点</li><li>新的编程语言趋向于更加简洁、增加开发效率</li><li>为了适应不同的应用场景，新的编程语言就诞生了</li></ol><h2 id="_2-利用汇编挖掘编程语言本质" tabindex="-1"><a class="header-anchor" href="#_2-利用汇编挖掘编程语言本质" aria-hidden="true">#</a> 2. 利用汇编挖掘编程语言本质</h2><h3 id="_2-1-错误示范" tabindex="-1"><a class="header-anchor" href="#_2-1-错误示范" aria-hidden="true">#</a> 2.1 错误示范</h3><ol><li>接触的第一门语言？JavaScript。</li><li>用过哪些编程语言？JavaScript，C/C++，Python，Java，……</li><li>是否思考过代码背后的原理？可能有。</li><li>是否接触过汇编语言？没有。</li><li>学习编程语言/技术的方式？学习文档，然后直接用。</li></ol><p>中文资料的巨大缺点：</p><ul><li>不专业</li><li>错误多</li></ul><p>掌握验证知识点的方法</p><ul><li>解决困惑</li><li>快速进阶</li></ul><p>国内技术氛围：</p><ol><li>非专业 / 非本科班出身</li><li>抄袭严重</li><li>过于势利，不是很纯粹</li></ol><h3 id="_2-2-学习建议" tabindex="-1"><a class="header-anchor" href="#_2-2-学习建议" aria-hidden="true">#</a> 2.2 学习建议</h3><ul><li>首选官方资料</li><li>英文资料 &gt; 中文资料</li><li>掌握验证知识正确性的方法 <ul><li>如果是编程语言的相关语言，掌握汇编语言是靠谱的方式</li></ul></li><li>掌握汇编的好处 <ul><li>掌握本质</li><li>破解</li><li>外挂</li></ul></li></ul><p>对本质的理解，例如：</p><ul><li><code>sizeof()</code> 的本质</li><li><code>a++</code> 与 <code>++a</code> 的区别</li><li><code>if-else</code> 与 <code>switch</code> 谁的效率高</li><li>程序的内存布局</li><li>多态的实现原理</li></ul><p><code>sizeof</code> 的本质是编译器行为：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>中 <code>sizeof(int)</code> 是编译器直接替换为 <code>4</code>（在 Windows x86 下）。</p><h3 id="_2-3-程序的本质" tabindex="-1"><a class="header-anchor" href="#_2-3-程序的本质" aria-hidden="true">#</a> 2.3 程序的本质</h3><ul><li>程序的执行过程</li><li>程序从硬盘装载到内存</li><li>CPU 读写 内存</li><li>CPU 控制 设备 (显示器 / 话筒 / ...)</li></ul><p>CPU 读写原理：寄存器与内存，举例：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b <span class="token operator">=</span> a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre></div><p>示例过程：</p><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>mov <span class="token register variable">eax</span>, <span class="token operator">[</span>a<span class="token operator">]</span>
add <span class="token register variable">eax</span>, <span class="token number">1</span>
mov <span class="token operator">[</span>b<span class="token operator">]</span>, <span class="token register variable">eax</span>
</code></pre></div><p>使用 Visual Studio 反汇编：</p><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>mov <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span>a<span class="token operator">]</span>
add <span class="token register variable">eax</span>, <span class="token number">1</span>
mov dword ptr <span class="token operator">[</span>b<span class="token operator">]</span>, <span class="token register variable">eax</span>
</code></pre></div><p>如何查看反汇编？</p><ol><li>设置断点</li><li>调试运行</li><li>右键，转到反汇编</li></ol><h3 id="_2-4-编程语言的发展" tabindex="-1"><a class="header-anchor" href="#_2-4-编程语言的发展" aria-hidden="true">#</a> 2.4 编程语言的发展</h3><p>编译器：编译前端 | 编译后端。</p><ul><li>高级语言</li><li>汇编语言</li><li>机器语言</li></ul><h3 id="_2-5-编程语言的本质区别" tabindex="-1"><a class="header-anchor" href="#_2-5-编程语言的本质区别" aria-hidden="true">#</a> 2.5 编程语言的本质区别</h3><ul><li>C++ <ul><li>轻易地反汇编</li></ul></li><li>JavaScript <ul><li>脚本语言</li><li>由浏览器去解析</li></ul></li></ul><div class="language-javascript" data-ext="js"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Hello World!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>PHP：</p><ul><li>脚本语言</li><li>由 <code>Zend Engine (ZE)</code> 去解析</li></ul><div class="language-php" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;Hello World!&quot;</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre></div><p>Java</p><ul><li><code>JVM</code> 去装载字节码</li><li>编译为 <code>class</code> 字节码</li></ul><p>涵盖了 3 类语言：</p><ul><li>编译型语言</li><li>脚本语言</li><li>虚拟机语言</li></ul><h2 id="_3-基础语法-a" tabindex="-1"><a class="header-anchor" href="#_3-基础语法-a" aria-hidden="true">#</a> 3. 基础语法 A</h2><h3 id="_3-1-开发环境的搭建" tabindex="-1"><a class="header-anchor" href="#_3-1-开发环境的搭建" aria-hidden="true">#</a> 3.1 开发环境的搭建</h3><ul><li>C++ 语法阶段 <ul><li>Mac: Xcode</li><li>Windows: Visual Studio</li></ul></li><li>项目实战 <ul><li>Windows: Visual Studio</li></ul></li></ul><div class="hint-container tip"><p class="hint-container-title">VS 技巧</p><p>VS 的常用调试快捷键：</p><ul><li><code>F9</code> 切换断点</li><li><code>Ctrl + F5</code> 开始执行（不调试）</li><li><code>F5</code> 开始调试、继续</li><li><code>Shift + F5</code> 停止调试</li><li><code>Ctrl + Shift + F5</code> 重启调试</li><li><code>F10</code> 单步执行，跳过子函数 (step over)</li><li><code>F11</code> 单步执行，含子函数 (step into)</li><li><code>Shift + F11</code> 在子函数内跳过 (step out)</li><li><code>Ctrl + J</code> 语法提示</li><li><code>Tab</code> 选择和使用智能提示内容</li></ul><p>VS 的常用组合快捷键：</p><ul><li><code>Ctrl + M, M</code> 折叠或展开当前方法</li><li><code>Ctrl + M, O</code> 折叠所有方法</li><li><code>Ctrl + M, L</code> 展开所有方法</li></ul></div><h3 id="_3-2-cin-cout" tabindex="-1"><a class="header-anchor" href="#_3-2-cin-cout" aria-hidden="true">#</a> 3.2 <code>cin</code> / <code>cout</code></h3><ul><li>C++ 文件 <code>.cpp</code>，<code>.cc</code></li><li>程序入口 <code>main()</code> 函数</li><li>C++ 兼容 C 的语法，C with classes</li><li>C++ 的标准化 <ul><li>C++98</li><li>C++03(bug fixed)</li><li>C++11</li><li>C++14</li><li>C++17</li><li>C++20</li></ul></li></ul><p>在控制台输入，输出，<code>cin</code>、<code>cout</code>。</p><ul><li>C++ 头文件不必要写 <code>.h</code>，几乎只有标准库没有写 <code>.h</code></li><li><code>cin</code>、<code>cout</code> 进行了运算符重载</li></ul><h3 id="_3-3-函数重载-1" tabindex="-1"><a class="header-anchor" href="#_3-3-函数重载-1" aria-hidden="true">#</a> 3.3 函数重载 1</h3><ul><li>C 语言不支持函数重载</li><li>C++ 支持函数重载</li></ul><p>函数名相同，但参数不同的函数构成重载：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">,</span> <span class="token keyword">int</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>函数名相同，但参数类型不同的函数也构成重载：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">double</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">double</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>注意：返回值类型与重载无关。</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 这是不允许的</span>
<span class="token keyword">double</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">double</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">double</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>实参的隐式转换也可能产生重载的二义性：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">double</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">long</span> v1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 这个也是错误的，不允许</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">sum</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-4-函数重载-2-name-mangling" tabindex="-1"><a class="header-anchor" href="#_3-4-函数重载-2-name-mangling" aria-hidden="true">#</a> 3.4 函数重载 2：name mangling</h3><ul><li>C++ 为什么支持函数重载？</li><li>因为 C++ 编译底层采取了 name mangling 技术</li><li>可以使用反汇编了解底层</li></ul><h3 id="_3-5-函数重载-3-利用-ida-分析-exe" tabindex="-1"><a class="header-anchor" href="#_3-5-函数重载-3-利用-ida-分析-exe" aria-hidden="true">#</a> 3.5 函数重载 3：利用 IDA 分析 <code>.exe</code></h3><ul><li><code>Debug</code> 模式，包含很多调试信息</li><li><code>Release</code> 模式，去除调试信息，进行了优化</li><li><code>IDA</code> 可以直接看到函数名称、参数、汇编指令</li><li>不同的编译器有不同的行为（<code>MSVC</code>、<code>g++</code>）</li></ul><h3 id="_3-6-默认参数" tabindex="-1"><a class="header-anchor" href="#_3-6-默认参数" aria-hidden="true">#</a> 3.6 默认参数</h3><ul><li>C++ 支持默认参数</li><li>有了默认参数可以忽略实参</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2 <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v1 <span class="token operator">+</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>默认参数只能放在非默认参数右边</li><li>函数如果同时有声明和实现，默认参数只能放在 <strong>声明</strong> 中</li><li>默认参数可以是 <strong>常量</strong> 或 <strong>全局变量</strong></li><li><code>MSVC</code> 自动为 <code>main()</code> 函数加入 <code>return 0;</code></li></ul><p>提示：函数指针的用法：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;test(int) - &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">=</span> test<span class="token punctuation">;</span>
    <span class="token function">p</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>更复杂的例子：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;iostream&gt;</span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;test(int) - &quot;</span> <span class="token operator">&lt;&lt;</span> a <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">void</span><span class="token punctuation">(</span><span class="token operator">*</span>p<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">=</span> test<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">p</span><span class="token punctuation">(</span>v1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 也就是说，</span>
    <span class="token comment">// 函数的默认参数也可以是函数类型，可以是已经声明过的常量</span>
    <span class="token function">func</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> test<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>什么时候用默认参数？</li><li>函数的实参经常是同一个值考虑默认参数</li></ul><p>那么，默认参数的本质是什么？</p><p>默认参数的情况：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2 <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v1 <span class="token operator">+</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 1. 尝试调用 sum(1, 2)</span>
<span class="token comment">// 2. 尝试调用 sum(1)</span>
</code></pre></div><ol><li>汇编代码：<div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>push <span class="token number">2</span>
push <span class="token number">1</span>
call sum
add <span class="token register variable">esp</span>, <span class="token number">8</span>
</code></pre></div></li><li>汇编代码：<div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>push <span class="token number">4</span>
push <span class="token number">1</span>
call sum
add <span class="token register variable">esp</span>, <span class="token number">8</span>
</code></pre></div></li></ol><p>也就是说，<code>sum(1)</code> 与 <code>sum(1, 4)</code> 编译后完全一致，为机器码 <code>E8 (call)</code>。</p><h3 id="_3-7-extern-c-1-作用" tabindex="-1"><a class="header-anchor" href="#_3-7-extern-c-1-作用" aria-hidden="true">#</a> 3.7 <code>extern &quot;C&quot;</code> 1：作用</h3><p>被 <code>extern &quot;C&quot;</code> 修饰的代码会按照 C 语言的方式编译。</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token keyword">void</span> <span class="token function">func_1</span><span class="token punctuation">(</span><span class="token keyword">int</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">func_2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>如果函数同时有声明和实现，那么必须修饰声明，实现修饰可选。</p><h3 id="_3-8-extern-c-2-c-c-混合开发" tabindex="-1"><a class="header-anchor" href="#_3-8-extern-c-2-c-c-混合开发" aria-hidden="true">#</a> 3.8 <code>extern &quot;C&quot;</code> 2：C/C++ 混合开发</h3><p>C++ 不可以直接去调用 C 函数，例如下面这两个函数是 C 语言实现的：</p><div class="language-c" data-ext="c"><pre class="language-c"><code><span class="token comment">// two_func.c</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v1 <span class="token operator">+</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>v1 <span class="token operator">&gt;</span> v2<span class="token punctuation">)</span><span class="token operator">?</span> v1 <span class="token operator">:</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>接下来在 C++ 中直接调用会出错：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// main.cpp</span>
<span class="token comment">// 声明部分</span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>改为：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-9-extern-c-3-cplusplus" tabindex="-1"><a class="header-anchor" href="#_3-9-extern-c-3-cplusplus" aria-hidden="true">#</a> 3.9 <code>extern &quot;C&quot;</code> 3：<code>__cplusplus</code></h3><p>头文件进行声明很重要，可用简化操作，例如，下面有一个 C++ 文件：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;mymath.h&quot;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在头文件这样声明：</p><div class="language-h" data-ext="h"><pre class="language-h"><code>// 如果是 C++ 则执行，C 不执行
#ifdef __cplusplus
extern &quot;C&quot; {
#endif
int sum(int v1, int v2);
int max(int v1, int v2);
#ifdef __cplusplus
}
#endif
</code></pre></div><p>在自己的函数中也要包含自己的头文件，这样可以保证自己的函数可以相互调用。</p><p>这样，我们的头文件既可以在 C 下引用，也可以在 C++ 中调用。</p><h3 id="_3-10-extern-c-4-ifndef-define-endif" tabindex="-1"><a class="header-anchor" href="#_3-10-extern-c-4-ifndef-define-endif" aria-hidden="true">#</a> 3.10 <code>extern &quot;C&quot;</code> 4：<code>#ifndef</code> / <code>#define</code> / <code>#endif</code></h3><p>防止头文件被重复包含：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">__MYMATH_H</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">__MYMATH_H</span></span>
<span class="token comment">// 内容开始</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token keyword">extern</span> <span class="token string">&quot;C&quot;</span> <span class="token punctuation">{</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">max</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">__cplusplus</span></span>
<span class="token punctuation">}</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
<span class="token comment">// 内容结束</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-基础语法-b" tabindex="-1"><a class="header-anchor" href="#_4-基础语法-b" aria-hidden="true">#</a> 4. 基础语法 B</h2><h3 id="_4-1-extern-c-5-pragma-once" tabindex="-1"><a class="header-anchor" href="#_4-1-extern-c-5-pragma-once" aria-hidden="true">#</a> 4.1 <code>extern &quot;C&quot;</code> 5：<code>#pragma once</code></h3><ul><li>我们经常使用 <code>#ifndef</code>、<code>#define</code>、<code>#endif</code> 来防止重复包含</li><li><code>#pragma once</code> 也可以防止被重复包含</li><li>这是一个编译器特性，<code>MSVC</code> 支持这一点</li><li>一些旧版本的编译器不支持这一点</li></ul><p>但是又一些区别：</p><ul><li><code>#pragma once</code> 只能防止整个头文件被重复包含</li><li>但是 <code>#ifndef</code> 可以防止任意一个部分</li></ul><h3 id="_4-2-内联函数-1" tabindex="-1"><a class="header-anchor" href="#_4-2-内联函数-1" aria-hidden="true">#</a> 4.2 内联函数 1</h3><p>使用 <code>inline</code> 修饰的函数声明或者实现，可以使函数变为内联函数：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">inline</span> <span class="token keyword">void</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;func()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>建议声明和实现都写：</p><ul><li>内联的含义是 <strong>函数调用展开为函数体的代码</strong></li><li>函数调用是有代价的，内联可以优化速度</li></ul><p>那么声明时候使用？</p><ol><li>函数代码体积不是很大</li><li>频繁调用</li></ol><p>内联不是一定的：</p><ul><li>是否内联是由编译器决定的</li><li>写了内联不一定内联，不写也不一定不内联</li><li>例如，<strong>递归函数</strong> 是不会被内联的</li></ul><h3 id="_4-3-内联函数-2-本质" tabindex="-1"><a class="header-anchor" href="#_4-3-内联函数-2-本质" aria-hidden="true">#</a> 4.3 内联函数 2：本质</h3><p>VS 需要设置优化选项才可以看到，VS 设置禁止优化步骤如下：</p><ol><li>属性</li><li>C/C++</li><li>优化 (禁用)</li><li>内联 (适用任何项)</li></ol><p>查看反汇编代码，可以看到区别：</p><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>mov <span class="token register variable">eax</span>, <span class="token number">0ah</span>
add <span class="token register variable">eax</span>, <span class="token number">14h</span>
mov dword ptr <span class="token operator">[</span>c<span class="token operator">]</span>, <span class="token register variable">eax</span>
</code></pre></div><p>也可以通过 IDA 反编译可执行文件，可以看到函数列表的区别。</p><h3 id="_4-4-内联函数-3-宏" tabindex="-1"><a class="header-anchor" href="#_4-4-内联函数-3-宏" aria-hidden="true">#</a> 4.4 内联函数 3：宏</h3><p>内联函数和宏，都可以减少函数调用开销：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 宏代码</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">add</span><span class="token expression"><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span> v1 <span class="token operator">+</span> v2</span></span>
<span class="token comment">// 内联函数</span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> v1<span class="token punctuation">,</span> <span class="token keyword">int</span> v2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> v1 <span class="token operator">+</span> v2<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>内联函数有函数特性</li><li>语法提示全面</li><li>宏是简单的文本替换</li></ul><p>思考以下代码：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name function">sum</span><span class="token expression"><span class="token punctuation">(</span>x<span class="token punctuation">)</span> x <span class="token operator">+</span> x</span></span>
<span class="token keyword">inline</span> <span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> x <span class="token operator">+</span> x<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// 执行下面代码，结果一样吗</span>
<span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span>a<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>表达式被赋值：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token punctuation">(</span>a <span class="token operator">=</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token comment">// 相当于</span>
a <span class="token operator">=</span> b<span class="token punctuation">;</span>
a <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre></div><p>例子 2：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b <span class="token operator">?</span> a <span class="token operator">:</span> b<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token comment">// 相当于</span>
<span class="token keyword">if</span><span class="token punctuation">(</span>a <span class="token operator">&gt;</span> b<span class="token punctuation">)</span>
    a <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
    b <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
</code></pre></div><p>赋值给表达式是 C++ 的一个特性，C 语言不允许。</p><h3 id="_4-5-const" tabindex="-1"><a class="header-anchor" href="#_4-5-const" aria-hidden="true">#</a> 4.5 <code>const</code></h3><ul><li><code>const</code> 声明一个常量</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>如果修饰一个类或结构体的实例，那么它的成员不可以更改</li><li>修饰一个指针时，不能通过指针修改成员变量</li></ul><p>下面的 5 个指针什么意思：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> p4 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span> <span class="token keyword">const</span> p5 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
</code></pre></div><ul><li><code>const</code> 修饰的是他右边的内容</li><li>变量类型与 <code>const</code> 是可以交换的，没有区别</li></ul><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token comment">// p1 不是常量，*p2 是常量</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token comment">// 与 p1 含义一致</span>
<span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token comment">// p3 是常量，*p3 不是常量</span>
<span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token comment">// p4 是常量 *p4 是常量</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> p4 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token comment">// 与 p4 含义一致</span>
<span class="token keyword">int</span> <span class="token keyword">const</span> <span class="token operator">*</span> <span class="token keyword">const</span> p5 <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>举个例子，你可以把代码复制到 VS 或 VS Code：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Student stu1 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    Student stu2 <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">20</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> Student <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>stu1<span class="token punctuation">;</span>
    <span class="token operator">*</span>p1 <span class="token operator">=</span> stu2<span class="token punctuation">;</span>     <span class="token comment">// 错误</span>
    <span class="token punctuation">(</span><span class="token operator">*</span>p1<span class="token punctuation">)</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span> <span class="token comment">// 错误</span>
    p1<span class="token operator">-&gt;</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>   <span class="token comment">// 错误</span>
    p1 <span class="token operator">=</span> <span class="token operator">&amp;</span>stu2<span class="token punctuation">;</span>

    Student <span class="token operator">*</span><span class="token keyword">const</span> p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>stu2<span class="token punctuation">;</span>
    <span class="token operator">*</span>p2 <span class="token operator">=</span> stu1<span class="token punctuation">;</span>
    <span class="token punctuation">(</span><span class="token operator">*</span>p2<span class="token punctuation">)</span><span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
    p2<span class="token operator">-&gt;</span>age <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
    p2 <span class="token operator">=</span> <span class="token operator">&amp;</span>stu1<span class="token punctuation">;</span> <span class="token comment">// 错误</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>不可以通过 <code>const *p</code> 指针去直接或间接修改所指向的空间</li><li>但是指针变量是 <code>const</code>，指针不是时，可以修改</li></ul><h3 id="_4-6-引用-1" tabindex="-1"><a class="header-anchor" href="#_4-6-引用-1" aria-hidden="true">#</a> 4.6 引用 1</h3><p><strong>引用</strong>（Reference）的本质是指针，C 语言通常用指针访问变量：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>refAge <span class="token operator">=</span> age<span class="token punctuation">;</span>
refAge <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>引用相当于变量的别名</li><li>对引用计算，相当于对引用指向的变量计算</li><li>引用不可以改变，在定义时初始化</li><li>可以使用引用初始化另一个引用</li><li>引用的价值：比指针更安全，函数的返回值可以被赋值</li></ul><p>指针型交换变量值：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">swap_pointer</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span>v1<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">*</span>v2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> <span class="token operator">*</span>v1<span class="token punctuation">;</span>
    <span class="token operator">*</span>v1 <span class="token operator">=</span> <span class="token operator">*</span>v2<span class="token punctuation">;</span>
    <span class="token operator">*</span>v2 <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">swap_pointer</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v1<span class="token punctuation">,</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>引用型交换变量值：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">void</span> <span class="token function">swap_ref</span><span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">&amp;</span>v1<span class="token punctuation">,</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>v2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> temp <span class="token operator">=</span> v1<span class="token punctuation">;</span>
    v1 <span class="token operator">=</span> v2<span class="token punctuation">;</span>
    v2 <span class="token operator">=</span> temp<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    <span class="token function">swap_ref</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> v2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>引用必须在创建时赋值</li><li>不存在：引用的引用、指向引用的指针、引用数组</li><li>基本数据类型、枚举、结构体、类、指针、数组等，都可以有引用</li></ul><h3 id="_4-7-引用-2" tabindex="-1"><a class="header-anchor" href="#_4-7-引用-2" aria-hidden="true">#</a> 4.7 引用 2</h3><p>引用的本质是指针，是弱化的指针，那么如何看本质？</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> age<span class="token punctuation">;</span>
cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
cout <span class="token operator">&lt;&lt;</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
</code></pre></div><p>反汇编看汇编指令是一致的，数组的引用：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>ref1<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span>ref2 <span class="token operator">=</span> array<span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-8-汇编-1-x86-x64-汇编" tabindex="-1"><a class="header-anchor" href="#_4-8-汇编-1-x86-x64-汇编" aria-hidden="true">#</a> 4.8 汇编 1：x86_x64 汇编</h3><p><a href="https://ke.qq.com/teacher/199109106" target="_blank" rel="noopener noreferrer">讲师李明杰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 推荐的其他相关课程，如果想学习汇编关注：</p><ul><li><a href="https://ke.qq.com/course/348781" target="_blank" rel="noopener noreferrer"><em>利用汇编挖掘编程语言本质</em><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>（免费，推荐）</li><li>iOS 底层原理：上、下（付费 ￥3000+）</li></ul><p>汇编语言种类：</p><ul><li><code>8086</code> 汇编 (16bit)</li><li><code>x86</code> 汇编 (32bit)</li><li><code>x64</code> 汇编 (64bit)</li></ul><p>x64 汇编有两种汇编格式：</p><ul><li><code>Intel</code></li><li><code>AT &amp; T</code></li></ul><p>汇编语言特点：不区分大小写。</p><p>汇编代码规则：</p><ul><li>在 <code>AT&amp;T</code> 的 <code>jmp</code> 地址前面要加星号 <code>*</code></li><li><code>Intel</code> 的寄存器名称不带 <code>%</code></li><li>两种格式操作数顺序不同</li><li><code>AT&amp;T</code> 的立即数要加上 <code>$</code></li><li>下面我们用 <code>Intel</code> 汇编指令</li></ul><p>学习汇编的两大知识点：</p><ul><li>汇编指令</li><li>寄存器</li></ul><p>寄存器：</p><ul><li>通用寄存器 <code>(32bit)</code><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code><span class="token register variable">rax</span>, <span class="token register variable">rbx</span>, <span class="token register variable">rcx</span>, <span class="token register variable">rdx</span>
</code></pre></div></li><li>通用寄存器 <code>(64bit)</code><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code><span class="token register variable">eax</span>, <span class="token register variable">ebx</span>, <span class="token register variable">ecx</span>, <span class="token register variable">edx</span>
</code></pre></div></li></ul><p>寄存器长度区分，一般的规律</p><ul><li><code>R</code> 开头的寄存器是 <code>64bit</code> 的，占 8 字节</li><li><code>E</code> 开头的寄存器是 <code>32bit</code> 的，占 4 字节</li></ul><p>寄存器长度示例：</p><div class="language-log" data-ext="log"><pre class="language-log"><code><span class="token operator">|</span><span class="token number">63</span><span class="token operator">-</span><span class="token number">32</span><span class="token operator">|</span><span class="token number">31</span><span class="token operator">-</span><span class="token number">16</span><span class="token operator">|</span><span class="token number">15</span><span class="token operator">-</span><span class="token number">8</span> <span class="token operator">|</span> <span class="token number">7</span><span class="token operator">-</span><span class="token number">0</span> <span class="token operator">|</span>
            <span class="token operator">|</span> AH<span class="token punctuation">.</span> <span class="token operator">|</span> AL<span class="token punctuation">.</span> <span class="token operator">|</span>
            <span class="token operator">|</span> AX<span class="token punctuation">.</span>       <span class="token operator">|</span>
      <span class="token operator">|</span> EAX<span class="token punctuation">.</span>            <span class="token operator">|</span>
<span class="token operator">|</span> RAX<span class="token punctuation">.</span>                  <span class="token operator">|</span>
</code></pre></div><h3 id="_4-9-汇编-2-内联汇编" tabindex="-1"><a class="header-anchor" href="#_4-9-汇编-2-内联汇编" aria-hidden="true">#</a> 4.9 汇编 2：内联汇编</h3><p>C++ 内可以使用汇编：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    __asm <span class="token punctuation">{</span>
        mov eax<span class="token punctuation">,</span> a
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">; x64 asm</span>
mov <span class="token register variable">eax</span>, <span class="token number">10</span>
mov <span class="token register variable">rax</span>, <span class="token number">1122334455667788H</span>
</code></pre></div><h3 id="_4-10-汇编-3-mov-指令" tabindex="-1"><a class="header-anchor" href="#_4-10-汇编-3-mov-指令" aria-hidden="true">#</a> 4.10 汇编 3：<code>mov</code> 指令</h3><ul><li><code>mov</code> 语法<div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>mov dest, src
</code></pre></div></li><li><code>[...]</code> 里面是地址值</li></ul><p>举例：</p><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">; 将立即数 3 存入指定内存</span>
mov dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">]</span>, <span class="token number">3</span>
<span class="token comment">; 从指定地址读数据到寄存器</span>
mov <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span><span class="token number">1128H</span><span class="token operator">]</span>
</code></pre></div><h2 id="_5-基础语法-c" tabindex="-1"><a class="header-anchor" href="#_5-基础语法-c" aria-hidden="true">#</a> 5. 基础语法 C</h2><h3 id="_5-1-汇编-4-call-指令" tabindex="-1"><a class="header-anchor" href="#_5-1-汇编-4-call-指令" aria-hidden="true">#</a> 5.1 汇编 4：<code>call</code> 指令</h3><ul><li><code>call</code> 语法<div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>call addr
</code></pre></div></li><li>调用一个函数，<code>addr</code> 指代的地址并不是函数的地址</li><li>CPU 大小端模式，常用小端</li></ul><h3 id="_5-2-汇编-5-其他常见指令" tabindex="-1"><a class="header-anchor" href="#_5-2-汇编-5-其他常见指令" aria-hidden="true">#</a> 5.2 汇编 5：其他常见指令</h3><div class="language-nasm line-numbers-mode" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">; 将地址值赋值给 dest</span>
lea dest, <span class="token operator">[</span>addr<span class="token operator">]</span>
<span class="token comment">; 函数返回</span>
ret
<span class="token comment">; 异或，相当于 op1 = op1 ^ op2</span>
xor op1, op2
<span class="token comment">; 加法 op1 += op2</span>
add op1, op2
<span class="token comment">; op1 -= op2</span>
sub op1, op2
<span class="token comment">; op++</span>
inc op
<span class="token comment">; op--</span>
dec op
<span class="token comment">; 跳转，无条件</span>
jmp addr
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>j</code> 开头的一般是跳转</li><li><code>jne</code> 等含义解释如下</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;eq&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;neq&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-nasm line-numbers-mode" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">; int a = 10;</span>
mov         dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">]</span>, <span class="token number">0Ah</span>
<span class="token comment">; int b = 20;</span>
mov         dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">14h</span><span class="token operator">]</span>, <span class="token number">14h</span>
<span class="token comment">; if (a == b) {</span>
mov         <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">]</span>
cmp         <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">14h</span><span class="token operator">]</span>
jne         005A188A
<span class="token comment">; printf(&quot;eq&quot;);</span>
push        <span class="token number">5A7B30h</span>
call        005A10CD
add         <span class="token register variable">esp</span>, <span class="token number">4</span>
<span class="token comment">; } else {</span>
jmp         005A1897
<span class="token comment">; printf(&quot;neq&quot;);</span>
push        <span class="token number">5A7B34h</span>
call        005A10CD
add         <span class="token register variable">esp</span>, <span class="token number">4</span>
<span class="token comment">; }</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-3-汇编-6-intel-白皮书" tabindex="-1"><a class="header-anchor" href="#_5-3-汇编-6-intel-白皮书" aria-hidden="true">#</a> 5.3 汇编 6：Intel 白皮书</h3><p>如何学习汇编？</p><ol><li>从参考书中查找</li><li>从 Intel 参考手册里查找</li><li><a href="https://software.intel.com/en-us/articles/intel-sdm" target="_blank" rel="noopener noreferrer">Intel 白皮书<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ol><h3 id="_5-4-汇编-7-jcc" tabindex="-1"><a class="header-anchor" href="#_5-4-汇编-7-jcc" aria-hidden="true">#</a> 5.4 汇编 7：<code>JCC</code></h3><p>部分条件跳转指令：</p><ul><li><code>je</code>、<code>jz</code> 相等的时候跳转</li><li><code>jne</code>、<code>jnz</code> 不相等的时候跳转</li><li><code>js</code> 结果为负跳转</li><li><code>jns</code> 结果非负跳转</li></ul><h3 id="_5-5-汇编-8-反汇编分析" tabindex="-1"><a class="header-anchor" href="#_5-5-汇编-8-反汇编分析" aria-hidden="true">#</a> 5.5 汇编 8：反汇编分析</h3><p><code>mov</code> 不支持从内存到内存的操作。</p><h3 id="_5-6-引用-3-反汇编分析" tabindex="-1"><a class="header-anchor" href="#_5-6-引用-3-反汇编分析" aria-hidden="true">#</a> 5.6 引用 3：反汇编分析</h3><ul><li>C++ 如何使用指针赋值变量？</li><li>反汇编分析如下</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>mov dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">0ch</span><span class="token operator">]</span>, <span class="token number">3</span>
lea <span class="token register variable">eax</span>, <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">0ch</span><span class="token operator">]</span>
mov dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">18h</span><span class="token operator">]</span>, <span class="token register variable">eax</span>
mov <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">18h</span><span class="token operator">]</span>
mov dword ptr <span class="token operator">[</span><span class="token register variable">eax</span><span class="token operator">]</span>, <span class="token number">5</span>
</code></pre></div><h3 id="_5-7-引用-4-注意点" tabindex="-1"><a class="header-anchor" href="#_5-7-引用-4-注意点" aria-hidden="true">#</a> 5.7 引用 4：注意点</h3><p>结构体的引用：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Date</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> yaer<span class="token punctuation">;</span>
    <span class="token keyword">int</span> month<span class="token punctuation">;</span>
    <span class="token keyword">int</span> day<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
Date d <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
Date <span class="token operator">&amp;</span>ref <span class="token operator">=</span> d<span class="token punctuation">;</span>
</code></pre></div><p>指针的引用：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span><span class="token operator">&amp;</span>ref <span class="token operator">=</span> p<span class="token punctuation">;</span>
<span class="token operator">*</span>ref <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
</code></pre></div><p>数组的引用：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> array<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">&amp;</span>ref<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> array<span class="token punctuation">;</span>
</code></pre></div><p>补充：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 指针数组</span>
<span class="token keyword">int</span> <span class="token operator">*</span>arr1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 指向数组的指针</span>
<span class="token keyword">int</span> <span class="token punctuation">(</span><span class="token operator">*</span>arr<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-8-引用-5-const-引用" tabindex="-1"><a class="header-anchor" href="#_5-8-引用-5-const-引用" aria-hidden="true">#</a> 5.8 引用 5：<code>const</code> 引用</h3><p>常引用有什么意义？</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>age<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">&amp;</span>ref <span class="token operator">=</span> age<span class="token punctuation">;</span>
</code></pre></div><p>可以读取但不能修改。</p><p>下面的语句什么意思？</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">&amp;</span> <span class="token keyword">const</span> ref <span class="token operator">=</span> age<span class="token punctuation">;</span>
ref <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-9-引用-6-const-引用的特点" tabindex="-1"><a class="header-anchor" href="#_5-9-引用-6-const-引用的特点" aria-hidden="true">#</a> 5.9 引用 6：<code>const</code> 引用的特点</h3><p><strong>常引用</strong>（Const Reference）</p><ul><li>引用可以被 <code>const</code> 修饰，这样就无法通过引用修改数据了</li><li><code>const</code> 必须写在 &amp; 符号的左边，才能算是常引用</li><li>可以指向临时数据（常量、表达式、函数返回值等）</li><li>可以指向不同类型的数据</li><li>作为函数参数时（此规则也适用于 <code>const</code> 指针）</li><li>可以接受 <code>const</code> 和非 <code>const</code> 实参</li><li>非 <code>const</code> 引用，只能接受非 <code>const</code> 实参</li><li>可以跟非 <code>const</code> 引用构成重载</li></ul><p>注意：当常引用指向了不同类型的数据时，会产生临时变量，即引用指向的并不是初始化时的那个变量（可以反汇编查看）</p><h3 id="_5-10-引用-7-mov-指令补充、数组的引用" tabindex="-1"><a class="header-anchor" href="#_5-10-引用-7-mov-指令补充、数组的引用" aria-hidden="true">#</a> 5.10 引用 7：<code>mov</code> 指令补充、数组的引用</h3><ul><li>引用数组的方式，为什么可以这样写？</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> <span class="token operator">&amp;</span>ref2 <span class="token operator">=</span> array<span class="token punctuation">;</span>
</code></pre></div><ul><li>因为只有常引用才能引用一个常量</li></ul><h2 id="_6-面向对象-a" tabindex="-1"><a class="header-anchor" href="#_6-面向对象-a" aria-hidden="true">#</a> 6. 面向对象 A</h2><h3 id="_6-1-面向对象-1-类和对象" tabindex="-1"><a class="header-anchor" href="#_6-1-面向对象-1-类和对象" aria-hidden="true">#</a> 6.1 面向对象 1：类和对象</h3><p>面向对象的内容</p><ul><li>类</li><li>对象</li><li>成员变量，成员函数</li><li>封装、继承、多态……</li></ul><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::run() - Age=&quot;</span> <span class="token operator">&lt;&lt;</span> age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建对象方法 1</span>
    Person person<span class="token punctuation">;</span>
    <span class="token comment">// 创建对象方法 2</span>
    Perosn <span class="token operator">*</span>person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>C++ 的 <code>struct</code> 就是创建类</li><li><code>struct</code> 默认成员权限是 <code>pubilc</code></li><li><code>class</code> 默认成员权限是 <code>private</code></li></ul><p>我们先观察内存布局：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person person<span class="token punctuation">;</span>
    Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>person<span class="token punctuation">;</span>
    <span class="token comment">/*
    x64 运行环境
    函数栈顶
    -------------
    | 4B        |
    -------------
    | 8B        |
    -------------
    */</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>函数是不占用栈空间的</li><li>一个类只会保存一份成员函数、但是每个对象都都自己的成员变量</li></ul><h3 id="_6-2-面向对象-2-对象的内存" tabindex="-1"><a class="header-anchor" href="#_6-2-面向对象-2-对象的内存" aria-hidden="true">#</a> 6.2 面向对象 2：对象的内存</h3><p>既然每次运行的时候运行的成员函数是同一个，那么应该如何处理成员变量？</p><table><thead><tr><th>程序空间</th><th>存放数据</th></tr></thead><tbody><tr><td>栈空间</td><td>自动创建和回收的空间</td></tr><tr><td>堆空间</td><td>手动申请和释放的空间</td></tr><tr><td>代码区</td><td>执行代码的区域</td></tr><tr><td>全局区</td><td>用于存放全局变量等</td></tr></tbody></table><ul><li>普通函数 <code>call addr</code></li><li>成员函数<div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code>lea <span class="token register variable">ecx</span>, <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">0ch</span><span class="token operator">]</span>
call addr
</code></pre></div></li><li>这会把对象的指针传给寄存器</li></ul><h3 id="_6-3-面向对象-3-this" tabindex="-1"><a class="header-anchor" href="#_6-3-面向对象-3-this" aria-hidden="true">#</a> 6.3 面向对象 3：<code>this</code></h3><p>举例一个函数：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token operator">-&gt;</span>age <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>会被编译为</p><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">; ecx 是 person 所在的地址，放入 this 指针</span>
mov dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">]</span>, <span class="token register variable">ecx</span>
<span class="token comment">; this 指针放到 eax 中</span>
mov <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span><span class="token register variable">ebp</span><span class="token operator">-</span><span class="token number">8</span><span class="token operator">]</span>
<span class="token comment">; 3 复制到 eax 所指的地址</span>
mov dword ptr <span class="token operator">[</span><span class="token register variable">eax</span><span class="token operator">]</span>, <span class="token number">3</span>
</code></pre></div><h3 id="_6-4-面向对象-4-指针访问的本质" tabindex="-1"><a class="header-anchor" href="#_6-4-面向对象-4-指针访问的本质" aria-hidden="true">#</a> 6.4 面向对象 4：指针访问的本质</h3><p>如果类中有多个成员变量，对象的内存又是如何布局的？</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">int</span> height<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;id=&quot;</span> <span class="token operator">&lt;&lt;</span> id <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;age=&quot;</span> <span class="token operator">&lt;&lt;</span> age <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;height=&quot;</span> <span class="token operator">&lt;&lt;</span> height <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>读取、修改成员变量的地址值原理</li><li>从指针取出对象的地址</li><li>利用对象的地址 + 成员变量的偏移量计算出成员变量的地址</li></ul><h3 id="_6-5-面向对象-5-指针的思考题" tabindex="-1"><a class="header-anchor" href="#_6-5-面向对象-5-指针的思考题" aria-hidden="true">#</a> 6.5 面向对象 5：指针的思考题</h3><p>思考下面代码打印出的值：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person person<span class="token punctuation">;</span>
    person<span class="token punctuation">.</span>id <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    person<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span>
    person<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">30</span><span class="token punctuation">;</span>

    Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>Person <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span>person<span class="token punctuation">.</span>age<span class="token punctuation">;</span>
    p<span class="token operator">-&gt;</span>id <span class="token operator">=</span> <span class="token number">40</span><span class="token punctuation">;</span>
    p<span class="token operator">-&gt;</span>age <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>
    person<span class="token punctuation">.</span><span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>打印出的结果是<div class="language-c++" data-ext="c++"><pre class="language-c++"><code>id=10
age=40
height=50
</code></pre></div></li><li>如果用 <code>p-&gt;display()</code> 会怎么样？<div class="language-c++" data-ext="c++"><pre class="language-c++"><code>// 将 person 的地址传给函数
person.display();
// 将 p 的地址传给函数
p-&gt;display();
</code></pre></div></li></ul><p>这两个调用区别如下</p><table><thead><tr><th>index</th><th>id</th><th>age</th><th>height</th></tr></thead><tbody><tr><td><code>person.display()</code></td><td><code>[eax]</code></td><td><code>[eax + 4]</code></td><td><code>[eax + 8]</code></td></tr><tr><td><code>p-&gt;display()</code></td><td><code>[eax + 4]</code></td><td><code>[eax + 8]</code></td><td><code>[eax + 12]</code></td></tr></tbody></table><h3 id="_6-6-面向对象-6-0xcc" tabindex="-1"><a class="header-anchor" href="#_6-6-面向对象-6-0xcc" aria-hidden="true">#</a> 6.6 面向对象 6：<code>0xCC</code></h3><ul><li>上面的 <code>[eax + 12]</code> 通常为 <code>0xcc</code></li><li>新的栈空间会被 <code>0xcc</code> 填充</li></ul><div class="language-nasm" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">;断点指令 0xcc</span>
int3
</code></pre></div><h3 id="_6-7-内存-1-封装、内存布局、堆空间" tabindex="-1"><a class="header-anchor" href="#_6-7-内存-1-封装、内存布局、堆空间" aria-hidden="true">#</a> 6.7 内存 1：封装、内存布局、堆空间</h3><ul><li>封装是什么？</li><li>成员变量私有化，并设置 <code>get</code> 方法和 <code>set</code> 方法</li></ul><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
<span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
            m_age <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span>
            m_age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> m_age<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Person person<span class="token punctuation">;</span>
    person<span class="token punctuation">.</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> person<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>程序的内存布局：</p><p><img src="/vuepress-cpp-notes/assets/memery-3047c2cd.svg" alt="内存布局" loading="lazy"></p><ul><li>为什么需要堆空间？</li><li>因为这样程序可以自由地控制内存的生命周期、大小</li></ul><h3 id="_6-8-内存-2-malloc-free" tabindex="-1"><a class="header-anchor" href="#_6-8-内存-2-malloc-free" aria-hidden="true">#</a> 6.8 内存 2：<code>malloc</code> / <code>free</code></h3><ul><li>申请空间的方式？</li><li><code>malloc / free</code></li><li><code>new / delete</code></li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code>Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>Person <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span><span class="token number">10</span> <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>Person<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token comment">// p[0], p[1], p[2], ... , p[9]</span>
<span class="token comment">// ...</span>
<span class="token function">free</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_6-9-内存-3-new-delete" tabindex="-1"><a class="header-anchor" href="#_6-9-内存-3-new-delete" aria-hidden="true">#</a> 6.9 内存 3：<code>new</code> / <code>delete</code></h3><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 用法 1</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span> p<span class="token punctuation">;</span>
<span class="token comment">// 用法 2</span>
<span class="token keyword">char</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">delete</span><span class="token punctuation">[</span><span class="token punctuation">]</span> p<span class="token punctuation">;</span>
</code></pre></div><ul><li><code>new []</code> 与 <code>delete []</code> 对应</li><li><code>new</code> 与 <code>delete</code> 对应</li></ul><h3 id="_6-10-内存-4-堆空间的初始化" tabindex="-1"><a class="header-anchor" href="#_6-10-内存-4-堆空间的初始化" aria-hidden="true">#</a> 6.10 内存 4：堆空间的初始化</h3><ul><li>堆空间初始化问题</li><li>系统会不会初始化 <code>malloc</code> 的值？</li><li>经过测试 <strong>Windows 10 VS</strong> 下调试没有初始化</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code>size_t size <span class="token operator">=</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span> <span class="token operator">*</span><span class="token punctuation">)</span><span class="token function">malloc</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">memset</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>memset(pointer, data, size)</code> 将每一个字节设置为 <code>data</code></li><li>那么 <code>new</code> 是否会初始化？</li></ul><p>经过验证 VS，下面的语句行为不同：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// VS 不初始化，可能有的平台初始化</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">;</span>
<span class="token comment">// 初始化为 0，调用 memset</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 初始化为 5</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 没有初始化</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 都被初始化为 0</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 都被初始化为 0</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 第一个初始化为 5，后面的为 0</span>
<span class="token keyword">int</span> <span class="token operator">*</span>p7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token punctuation">{</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>清零对象或数组：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 清零一个对象</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>obj<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 清除对象数组</span>
<span class="token function">memset</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>arr<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_7-面向对象-b" tabindex="-1"><a class="header-anchor" href="#_7-面向对象-b" aria-hidden="true">#</a> 7. 面向对象 B</h2><h3 id="_7-1-内存-5-对象的内存" tabindex="-1"><a class="header-anchor" href="#_7-1-内存-5-对象的内存" aria-hidden="true">#</a> 7.1 内存 5：对象的内存</h3><p>对象可以放在 3 个地方</p><ul><li>全局区</li><li>栈空间</li><li>堆空间</li></ul><h3 id="_7-2-构造函数-1" tabindex="-1"><a class="header-anchor" href="#_7-2-构造函数-1" aria-hidden="true">#</a> 7.2 构造函数 1</h3><p><strong>构造函数</strong>（constructor）</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;new Person()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>没有返回值，可以有参数，可以重载</li><li>一旦定义了构造函数，就必须使用一个构造函数初始化</li><li><code>malloc()</code> 不会初始化对象</li></ul><blockquote><p>错误：<s>默认情况下，C++ 会为每一个类生成一个无参数的构造函数</s><br> 正确：特定情况下，编译器会为类创建构造函数</p></blockquote><h3 id="_7-3-构造函数-2" tabindex="-1"><a class="header-anchor" href="#_7-3-构造函数-2" aria-hidden="true">#</a> 7.3 构造函数 2</h3><p>注意函数声明和创建对象之间的区别：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 函数声明</span>
Person <span class="token function">person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建对象</span>
Person person1<span class="token punctuation">;</span>
Person <span class="token function">person1</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_7-4-成员变量的初始化" tabindex="-1"><a class="header-anchor" href="#_7-4-成员变量的初始化" aria-hidden="true">#</a> 7.4 成员变量的初始化</h3><ul><li>全局区</li><li>堆空间</li><li>栈空间</li></ul><p>如果没有实现构造函数：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 初始化</span>
Person person<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 没有初始化</span>
    Person person1<span class="token punctuation">;</span>
    <span class="token comment">// 没有初始化</span>
    Person <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">;</span>
    <span class="token comment">// 初始化</span>
    Person <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果有实现构造函数：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// 初始化</span>
Person person<span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 没有初始化</span>
    Person person1<span class="token punctuation">;</span>
    <span class="token comment">// 没有初始化</span>
    Person <span class="token operator">*</span>p1 <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">;</span>
    <span class="token comment">// 没有初始化</span>
    Person <span class="token operator">*</span>p2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-5-析构函数" tabindex="-1"><a class="header-anchor" href="#_7-5-析构函数" aria-hidden="true">#</a> 7.5 析构函数</h3><p><strong>析构函数</strong>（destructor）的构造如下</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;~Person()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>malloc</code>、<code>free</code> 不会调用构造函数和析构函数</li><li><code>new</code>、<code>delete</code> 会调用这两个函数，但是必须是 <code>public</code></li></ul><h3 id="_7-6-内存管理" tabindex="-1"><a class="header-anchor" href="#_7-6-内存管理" aria-hidden="true">#</a> 7.6 内存管理</h3><ul><li>对象内创建在堆空间的内容要被释放</li><li>否则可能出现内存泄露</li></ul><h3 id="_7-7-声明和实现分离" tabindex="-1"><a class="header-anchor" href="#_7-7-声明和实现分离" aria-hidden="true">#</a> 7.7 声明和实现分离</h3><ul><li>头文件</li></ul><div class="language-h line-numbers-mode" data-ext="h"><pre class="language-h"><code>#pragma once

class Person {
private:
    int m_age;
public:
    void setAge(int age);
    int getAge();
    Person();
    ~Person();
};
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>C++ 文件</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;Person.h&quot;</span></span>

<span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">void</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-8-命名空间" tabindex="-1"><a class="header-anchor" href="#_7-8-命名空间" aria-hidden="true">#</a> 7.8 命名空间</h3><ul><li>命名空间为了解决命名冲突的问题</li><li>命名空间可以嵌套</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">namespace</span> Demo <span class="token punctuation">{</span>
    <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
        <span class="token comment">// ...</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>存在默认命名空间 <code>::</code> （没有名称）</li><li>可以使用 <code>using Demo::Person</code> 引用一个名字</li><li>可以使用 <code>using namespace Demo;</code> 引入命名空间的全部内容</li><li>可以在变量前使用命名空间的符号指代命名空间</li></ul><p>下面是声明和实现分离的命名空间版本。</p><p>头文件：</p><div class="language-h line-numbers-mode" data-ext="h"><pre class="language-h"><code>#pragma once

namespace MPerson {
    class Person {
    private:
        int m_age;
    public:
        void setAge(int age);
        int getAge();
        Person();
        ~Person();
    };
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>C++ 文件：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;Person.h&quot;</span></span>
<span class="token keyword">namespace</span> MPerson <span class="token punctuation">{</span>
    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token operator">~</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token keyword">int</span> <span class="token class-name">Person</span><span class="token double-colon punctuation">::</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// 或者使用 using namespace MPerson;</span>
</code></pre></div><p>命名空间自动合并，多次声明有效。</p><h3 id="_7-9-继承" tabindex="-1"><a class="header-anchor" href="#_7-9-继承" aria-hidden="true">#</a> 7.9 继承</h3><p>C++ 没有类似于 Java、OC、Python 的基类。</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_no<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">study</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Student::study()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>Student</code> 是 <strong>子类</strong>（Subclass，<strong>派生类</strong>）</li><li><code>Person</code> 是 <strong>父类</strong>（Superclass，<strong>超类</strong>）</li><li>内存布局：父类成员在前面</li></ul><h3 id="_7-10-成员访问权限" tabindex="-1"><a class="header-anchor" href="#_7-10-成员访问权限" aria-hidden="true">#</a> 7.10 成员访问权限</h3><ul><li><code>public</code> 公共的，任何地方都可以访问</li><li><code>protected</code> 子类内部、当前类内部可以访问</li><li><code>private</code> 私有的，只有当前类内部可以访问</li></ul><p>可以在继承时声明权限：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">private</span> <span class="token class-name">Person</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_no<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">study</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Student::study()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>子类内部访问父类成员的权限，是以下两项中权限最小的那个</p><ul><li>成员本身的访问权限</li><li>上一级父类的继承方式</li></ul><p>其他结论：</p><ul><li><code>class</code> 默认为私有继承</li><li><code>struct</code> 默认为公共继承</li><li>开发中用的最多的继承方式是 <code>public</code>，这样能保留父类原来的成员访问权限</li><li>访问权限不影响对象的内存布局</li></ul><h2 id="_8-面向对象-c" tabindex="-1"><a class="header-anchor" href="#_8-面向对象-c" aria-hidden="true">#</a> 8. 面向对象 C</h2><h3 id="_8-1-初始化列表-1" tabindex="-1"><a class="header-anchor" href="#_8-1-初始化列表-1" aria-hidden="true">#</a> 8.1 初始化列表 1</h3><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_height<span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span> <span class="token operator">:</span><span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_height</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>这个操作与直接赋值的效率一致</li><li><code>:m_age(func(age) + 1)</code> 这样写也是可以的</li><li>初始化顺序只和类的成员顺序有关</li><li>初始化列表只能用于构造函数</li><li>可以和默认参数一起使用</li></ul><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token keyword">int</span> height <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span>
    <span class="token function">m_age</span><span class="token punctuation">(</span>age<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">m_height</span><span class="token punctuation">(</span>height<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre></div><ul><li>函数的 <strong>默认参数</strong> 只能放在 <strong>声明</strong> 中</li><li>如果声明和实现是分离的，只能将 <strong>初始化列表写在实现</strong> 中</li></ul><h3 id="_8-2-初始化列表-2-构造函数的互相调用" tabindex="-1"><a class="header-anchor" href="#_8-2-初始化列表-2-构造函数的互相调用" aria-hidden="true">#</a> 8.2 初始化列表 2：构造函数的互相调用</h3><p>构造函数可以相互调用，但是不可以直接调用，只能出现在初始化列表里：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token keyword">int</span> m_height<span class="token punctuation">;</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">,</span> <span class="token keyword">int</span> height<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        m_age <span class="token operator">=</span> age<span class="token punctuation">;</span>
        m_height <span class="token operator">=</span> height<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>下面的写法是错误的：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>因为这样就会创建了一个新的、临时的 <code>Person</code> 对象，然后传值。</p><h3 id="_8-3-初始化列表-3-父类的构造函数" tabindex="-1"><a class="header-anchor" href="#_8-3-初始化列表-3-父类的构造函数" aria-hidden="true">#</a> 8.3 初始化列表 3：父类的构造函数</h3><p>继承相关的构造函数：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_age<span class="token punctuation">;</span>
    <span class="token function">Person</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Person::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Student</span> <span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Person</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> m_no<span class="token punctuation">;</span>
    <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Student::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>创建 <code>Student</code> 对象时，先后调用了 <code>Person</code> 和 <code>Student</code> 的构造函数</li><li>子类的构造函数，默认会调用父类的无参数的构造函数</li><li>如果子类的构造函数 <strong>显式地调用了父类的有参构造函数</strong>，就不会再去默认调用父类的无参构造函数，但是只能在子类的 <strong>初始化列表</strong> 中使用</li><li>如果父类缺少无参构造函数，子类的构造函数必须显式调用父类的有参构造函数</li><li>构造函数与析构函数的执行顺序 <ol><li>父类构造函数</li><li>子类构造函数</li><li>子类析构函数</li><li>父类析构函数</li></ol></li></ul><h3 id="_8-4-多态-1" tabindex="-1"><a class="header-anchor" href="#_8-4-多态-1" aria-hidden="true">#</a> 8.4 多态 1</h3><p>面向对象 3 大特征：</p><ul><li>封装</li><li>继承</li><li>多态</li></ul><p>父类指针指向子类对象（安全的）</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// Student: Person</span>
Person <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Student</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>子类指针不允许指向父类对象（不安全、不允许）</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// !危险的代码</span>
Student <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>Student <span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><p>多态</p><ul><li>父类指针指向子类对象</li><li>同一操作作用于不同的对象，可以有不同的解释，产生不同的执行结果</li><li>在运行时，可以识别出真正的对象类型，调用对应子类中的函数</li></ul></li><li><p>重写</p><ul><li>子类重新实现父类方法</li><li>子类 <strong>重写</strong>（Override）父类的成员函数</li><li>父类指针指向子类对象</li><li>利用父类指针调用重写的成员函数</li></ul></li></ul><p>C++ 默认情况不会实现多态。</p><h3 id="_8-5-多态-2-虚函数" tabindex="-1"><a class="header-anchor" href="#_8-5-多态-2-虚函数" aria-hidden="true">#</a> 8.5 多态 2：虚函数</h3><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">struct</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Animal::speak()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Animal::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Dog</span><span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Animal</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Dog::speak()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Dog::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">struct</span> <span class="token class-name">Cat</span><span class="token operator">:</span> <span class="token base-clause"><span class="token class-name">Animal</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Cat::speak()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Cat::run()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>父类是 <strong>虚函数</strong>（Virtual Function），子类也自动声明为虚函数</li><li>虚函数实现了多态</li></ul><p>如果没有多态，默认根据 <code>p</code> 指针的类型来调用函数：</p><div class="language-cpp" data-ext="cpp"><pre class="language-cpp"><code><span class="token comment">// Student: Person</span>
Animal <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">Cat</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>汇编的不同：</p><div class="language-nasm line-numbers-mode" data-ext="nasm"><pre class="language-nasm"><code><span class="token comment">; 没有使用虚函数 p-&gt;speak();</span>
call Animal::speak()
<span class="token comment">; 使用了虚函数 p-&gt;speak();</span>
mov <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span>p<span class="token operator">]</span>
<span class="token comment">; 取出虚表的地址值</span>
mov <span class="token register variable">edx</span>, dword ptr <span class="token operator">[</span><span class="token register variable">eax</span><span class="token operator">]</span>
mov <span class="token register variable">esi</span>, <span class="token register variable">esp</span>
mov <span class="token register variable">ecx</span>, dword ptr <span class="token operator">[</span>p<span class="token operator">]</span>
mov <span class="token register variable">eax</span>, dword ptr <span class="token operator">[</span><span class="token register variable">edx</span><span class="token operator">]</span>
call <span class="token register variable">eax</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>E8 (call)</code> 直接调用函数</li><li><code>FF (call)</code> 间接调用函数，内容为函数的地址</li><li>虚函数：被 <code>virtual</code> 修饰的成员函数</li><li>只要在父类中声明为虚函数，子类中重写的函数也自动变成虚函数</li></ul><h3 id="_8-6-多态-3-虚表" tabindex="-1"><a class="header-anchor" href="#_8-6-多态-3-虚表" aria-hidden="true">#</a> 8.6 多态 3：虚表</h3><ul><li>包含虚函数的比没有虚函数的情况多了一个指针大小</li><li>这个指针指向了一个虚表</li><li>虚函数的实现原理是虚表，这个虚表里面存储着最终需要调用的虚函数地址，这个虚表也叫虚函数表</li></ul><h3 id="_8-7-多态-4-虚表的汇编分析" tabindex="-1"><a class="header-anchor" href="#_8-7-多态-4-虚表的汇编分析" aria-hidden="true">#</a> 8.7 多态 4：虚表的汇编分析</h3><ul><li>可以参考 ppt 中的表</li><li>与上一节原理一致</li></ul><h3 id="_8-8-多态-5-虚表的作用" tabindex="-1"><a class="header-anchor" href="#_8-8-多态-5-虚表的作用" aria-hidden="true">#</a> 8.8 多态 5：虚表的作用</h3><p>实现多态的 “动态性”。</p><h3 id="_8-9-多态-6-虚表的细节" tabindex="-1"><a class="header-anchor" href="#_8-9-多态-6-虚表的细节" aria-hidden="true">#</a> 8.9 多态 6：虚表的细节</h3><ul><li>子类如果没有实现父类的虚函数，虚表中会存放父类的虚函数</li><li>类中有虚函数，那么子类和父类都存在虚表，虚表不一样</li><li>子类声明为虚函数但父类不声明，则父类不是虚函数</li></ul><h3 id="_8-10-多态-7-调用父类的成员函数" tabindex="-1"><a class="header-anchor" href="#_8-10-多态-7-调用父类的成员函数" aria-hidden="true">#</a> 8.10 多态 7：调用父类的成员函数</h3><p>在子类的实现中，如果需要调用父类的方法，可以直接写父类的名称：</p><div class="language-cpp line-numbers-mode" data-ext="cpp"><pre class="language-cpp"><code><span class="token keyword">class</span> <span class="token class-name">Animal</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">virtual</span> <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Animal::speak()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">Cat</span><span class="token operator">:</span> <span class="token base-clause"><span class="token keyword">public</span> <span class="token class-name">Animal</span></span> <span class="token punctuation">{</span>
<span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token keyword">void</span> <span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Animal</span><span class="token double-colon punctuation">::</span><span class="token function">speak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        cout <span class="token operator">&lt;&lt;</span> <span class="token string">&quot;Cat::speak()&quot;</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><!--[--><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/Sun-ZhenXing/vuepress-cpp-notes//edit/main/docs/notebook/cpp-lang/chapter01/index.md" rel="noopener noreferrer" target="_blank" aria-label="在 GitHub 上编辑此页"><!--[--><!--]--> 在 GitHub 上编辑此页 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">上次更新: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">贡献者: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1006925066@qq.com">Sun-ZhenXing</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/vuepress-cpp-notes/assets/app-dd112ad8.js" defer></script>
  </body>
</html>
